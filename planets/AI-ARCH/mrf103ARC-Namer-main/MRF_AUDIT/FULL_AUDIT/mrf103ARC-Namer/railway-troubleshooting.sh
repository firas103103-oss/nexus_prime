#!/bin/bash

echo "ğŸ”§ Railway Deployment Troubleshooting Guide"
echo "=========================================="
echo ""

echo "ğŸ“‹ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© ÙˆØ­Ù„ÙˆÙ„Ù‡Ø§:"
echo ""

echo "1ï¸âƒ£  APPLICATION NOT FOUND (404)"
echo "   Ø§Ù„Ø³Ø¨Ø¨ Ø§Ù„Ù…Ø­ØªÙ…Ù„:"
echo "   - Build ÙØ´Ù„"
echo "   - START command Ø®Ø·Ø£"
echo "   - PORT variable Ù…Ø´ Ù…Ø­Ø¯Ø¯ ØµØ­"
echo ""
echo "   Ø§Ù„Ø­Ù„:"
echo "   â€¢ Ø±ÙˆØ­ Railway Dashboard â†’ mrf103-arc-ecosystem"
echo "   â€¢ Ø§Ø¶ØºØ· Deployments â†’ Ø´ÙˆÙ Ø¢Ø®Ø± deployment"
echo "   â€¢ Ø§Ø¶ØºØ· View Logs"
echo "   â€¢ Ø§Ø¨Ø­Ø« Ø¹Ù†:"
echo "     - Build errors"
echo "     - TypeScript compilation errors"
echo "     - Missing dependencies"
echo "     - Port binding errors"
echo ""

echo "2ï¸âƒ£  BUILD ERRORS"
echo "   Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©:"
echo "   - package-lock.json Ù…ÙÙ‚ÙˆØ¯ âœ… (ØªÙ… Ø§Ù„Ø¥ØµÙ„Ø§Ø­)"
echo "   - Dependencies Ù…Ø´ Ù…ØªÙˆØ§ÙÙ‚Ø©"
echo "   - TypeScript errors"
echo ""
echo "   Ø§Ù„ØªØ­Ù‚Ù‚:"
echo "   â€¢ ÙÙŠ Railway Logs Ø§Ø¨Ø­Ø« Ø¹Ù†:"
echo "     - 'npm ci' errors"
echo "     - 'tsc' compilation errors"
echo "     - 'Cannot find module' errors"
echo ""

echo "3ï¸âƒ£  START COMMAND FAILURE"
echo "   Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:"
echo "   - Ø§Ù„Ø£Ù…Ø± 'npm start' ÙØ´Ù„"
echo "   - dist/ folder Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯"
echo "   - server/index.js Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯"
echo ""
echo "   Ø§Ù„Ø­Ù„:"
echo "   â€¢ ØªØ£ÙƒØ¯ Ø¥Ù†:"
echo "     - Build command: npm run build"
echo "     - Start command: npm start"
echo "     - package.json â†’ scripts.start ØµØ­ÙŠØ­"
echo ""

echo "4ï¸âƒ£  PORT CONFIGURATION"
echo "   Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:"
echo "   - App Ø¨ØªØ³ØªÙ…Ø¹ Ø¹Ù„Ù‰ port ØºÙ„Ø·"
echo "   - Railway PORT variable Ù…Ø´ Ù…Ø¹Ø±Ù"
echo ""
echo "   Ø§Ù„Ø­Ù„:"
echo "   â€¢ ÙÙŠ Ø§Ù„ÙƒÙˆØ¯:"
echo "     const PORT = process.env.PORT || 5000;"
echo "   â€¢ ÙÙŠ Railway:"
echo "     PORT variable ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…Ø­Ø¯Ø¯ (Railway ÙŠØ¶ÙŠÙÙ‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)"
echo ""

echo "5ï¸âƒ£  ENVIRONMENT VARIABLES"
echo "   Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:"
echo "   âœ… NODE_ENV=production"
echo "   âœ… PORT (Railway ÙŠØ¶ÙŠÙÙ‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)"
echo "   âœ… DATABASE_URL"
echo "   âœ… OPENAI_API_KEY"
echo "   âœ… SUPABASE_URL"
echo "   âœ… SUPABASE_ANON_KEY"
echo "   âœ… SESSION_SECRET"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ“Š Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ´Ø®ÙŠØµ:"
echo ""
echo "1. Ø§ÙØªØ­ Railway Dashboard:"
echo "   https://railway.app/dashboard"
echo ""
echo "2. Ø§Ø®ØªØ§Ø± Ù…Ø´Ø±ÙˆØ¹: mrf103-arc-ecosystem"
echo ""
echo "3. Ø§Ø¶ØºØ· Deployments (Ø¢Ø®Ø± deployment)"
echo ""
echo "4. Ø§Ø¶ØºØ· View Logs"
echo ""
echo "5. Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡:"
echo "   - Build stage: Ø£Ø®Ø·Ø§Ø¡ npm install Ø£Ùˆ npm run build"
echo "   - Deploy stage: Ø£Ø®Ø·Ø§Ø¡ npm start"
echo "   - Runtime: Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚"
echo ""
echo "6. Ø§Ù†Ø³Ø® Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ ÙˆØ£Ø±Ø³Ù„Ù‡Ø§"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ” ÙØ­Øµ Ø³Ø±ÙŠØ¹ Ù„Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª:"
echo ""

echo "   railway.json:"
echo "   âœ“ builder: DOCKERFILE"
echo "   âœ“ startCommand: npm start"
echo "   âœ“ healthcheckPath: /api/health"
echo ""

echo "   Dockerfile:"
echo "   âœ“ Multi-stage build"
echo "   âœ“ npm ci --legacy-peer-deps"
echo "   âœ“ npm run build:client && npm run build:server"
echo "   âœ“ CMD [\"npm\", \"start\"]"
echo ""

echo "   package.json:"
echo "   âœ“ build: npm run build:client && npm run build:server"
echo "   âœ“ build:client: vite build"
echo "   âœ“ build:server: tsc --outDir dist"
echo "   âœ“ start: node dist/server/index.js"
echo ""

echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "âš¡ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø³Ø±ÙŠØ¹:"
echo ""
echo "1. Ø§ÙØªØ­ Railway Logs"
echo "2. Ø§Ù†Ø³Ø® Ø¢Ø®Ø± 50 Ø³Ø·Ø± Ù…Ù† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡"
echo "3. Ø£Ø±Ø³Ù„Ù‡Ù… Ù‡Ù†Ø§"
echo "4. Ø³Ù†Ø­Ù„ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ù…Ø¨Ø§Ø´Ø±Ø©!"
echo ""
