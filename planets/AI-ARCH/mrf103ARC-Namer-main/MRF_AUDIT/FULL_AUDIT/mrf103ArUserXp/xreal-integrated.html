<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XReal AR - Ultimate Reality System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #000000;
            color: #00d4ff;
            overflow-x: hidden;
            min-height: 100vh;
            width: 100vw;
        }

        #hud-container {
            position: relative;
            width: 100%;
            min-height: 100vh;
            background: radial-gradient(ellipse at center, rgba(0, 50, 80, 0.3) 0%, rgba(0, 0, 0, 0.9) 70%);
            overflow-x: hidden;
            padding-bottom: 100px;
        }

        .hud-grid {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0, 212, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 212, 255, 0.1) 1px, transparent 1px);
            background-size: 40px 40px;
            pointer-events: none;
            animation: gridPulse 4s ease-in-out infinite;
            z-index: 0;
        }

        @keyframes gridPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.1; }
        }

        .hud-panel {
            position: relative;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.15) 0%, rgba(0, 150, 200, 0.05) 100%);
            border: 1px solid rgba(0, 212, 255, 0.5);
            border-radius: 8px;
            backdrop-filter: blur(10px);
            padding: 15px;
            font-size: 12px;
            animation: panelSlideIn 0.8s ease-out;
            box-shadow: 
                0 0 20px rgba(0, 212, 255, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            margin: 10px;
        }

        .hud-panel.active {
            border-color: #00ff88;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.5);
        }

        @keyframes panelSlideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .status-title {
            color: #00ff88;
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .status-value {
            color: #ffffff;
            font-weight: bold;
        }

        .connection-indicator {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            padding: 5px 15px;
            background: rgba(0, 255, 136, 0.2);
            border: 1px solid #00ff88;
            border-radius: 15px;
            font-size: 10px;
            color: #00ff88;
            z-index: 1000;
        }

        .connection-indicator.disconnected {
            background: rgba(255, 0, 0, 0.2);
            border-color: #ff4444;
            color: #ff4444;
        }

        .main-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            padding: 50px 15px 15px;
            max-width: 1600px;
            margin: 0 auto;
        }

        .action-btn {
            display: block;
            width: 100%;
            margin-bottom: 8px;
            padding: 12px;
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 6px;
            color: #00d4ff;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
        }

        .action-btn:hover {
            background: rgba(0, 255, 136, 0.2);
            border-color: #00ff88;
            color: #00ff88;
            transform: translateX(5px);
        }

        .action-btn.processing {
            background: rgba(255, 165, 0, 0.2);
            border-color: #ffa500;
            color: #ffa500;
        }

        .experience-selector {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: center;
            background: rgba(0, 0, 0, 0.8);
            padding: 10px;
            border-radius: 25px;
            border: 1px solid rgba(0, 212, 255, 0.3);
            z-index: 100;
        }

        .experience-btn {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.2) 0%, rgba(0, 150, 200, 0.1) 100%);
            border: 1px solid rgba(0, 212, 255, 0.5);
            border-radius: 20px;
            padding: 8px 16px;
            color: #00d4ff;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .experience-btn:hover, .experience-btn.active {
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.3) 0%, rgba(0, 200, 100, 0.1) 100%);
            border-color: #00ff88;
            color: #00ff88;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
        }

        .notification-popup {
            position: fixed;
            top: 50px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, rgba(0, 255, 136, 0.9) 0%, rgba(0, 200, 100, 0.7) 100%);
            border: 1px solid #00ff88;
            border-radius: 8px;
            padding: 15px 25px;
            color: #fff;
            font-size: 13px;
            z-index: 2000;
            animation: notificationSlide 0.5s ease-out;
            box-shadow: 0 0 30px rgba(0, 255, 136, 0.6);
            max-width: 90%;
        }

        @keyframes notificationSlide {
            from { opacity: 0; transform: translateX(-50%) translateY(-30px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }

        .call-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .call-overlay.active {
            display: flex;
            animation: callActivate 0.5s ease-out;
        }

        @keyframes callActivate {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        .call-info { text-align: center; margin-bottom: 30px; }
        .call-contact { font-size: 32px; color: #00ff88; margin-bottom: 10px; text-shadow: 0 0 20px #00ff88; }
        .call-status { font-size: 18px; color: #00d4ff; margin-bottom: 5px; }
        .call-duration { font-size: 16px; color: #ffffff; font-family: monospace; }

        .call-controls { display: flex; gap: 20px; margin-top: 30px; }
        .call-btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: 2px solid;
            background: transparent;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .call-btn.end { border-color: #ff4444; color: #ff4444; }
        .call-btn.end:hover { background: #ff4444; color: #000; box-shadow: 0 0 30px #ff4444; }

        .audio-visualizer {
            display: none;
            gap: 3px;
            align-items: end;
            height: 40px;
            margin-top: 20px;
        }

        .audio-bar {
            width: 4px;
            background: linear-gradient(to top, #00d4ff, #00ff88);
            border-radius: 2px;
            animation: audioWave 0.5s ease-in-out infinite alternate;
        }

        .audio-bar:nth-child(2) { animation-delay: 0.1s; }
        .audio-bar:nth-child(3) { animation-delay: 0.2s; }
        .audio-bar:nth-child(4) { animation-delay: 0.3s; }
        .audio-bar:nth-child(5) { animation-delay: 0.4s; }

        @keyframes audioWave {
            from { height: 5px; }
            to { height: 25px; }
        }

        /* Jarvis AI Panel */
        .jarvis-panel {
            background: linear-gradient(135deg, rgba(255, 136, 0, 0.15) 0%, rgba(255, 100, 0, 0.05) 100%);
            border-color: rgba(255, 136, 0, 0.5);
        }

        .jarvis-panel .status-title { color: #ff8800; }

        .jarvis-input {
            width: 100%;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 136, 0, 0.3);
            border-radius: 20px;
            padding: 10px 15px;
            color: #fff;
            font-size: 12px;
            margin-bottom: 10px;
        }

        .jarvis-response {
            background: rgba(255, 136, 0, 0.1);
            border-radius: 8px;
            padding: 10px;
            min-height: 60px;
            font-size: 12px;
            line-height: 1.5;
            color: #ffcc00;
        }

        .jarvis-voice-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 136, 0, 0.2);
            border: 2px solid #ff8800;
            color: #ff8800;
            font-size: 20px;
            cursor: pointer;
            margin: 10px auto;
            display: block;
            transition: all 0.3s;
        }

        .jarvis-voice-btn.listening {
            animation: pulse 1s infinite;
            background: rgba(255, 136, 0, 0.4);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 136, 0, 0.5); }
            50% { transform: scale(1.1); box-shadow: 0 0 20px 10px rgba(255, 136, 0, 0.3); }
        }

        /* Health Panel */
        .health-panel {
            background: linear-gradient(135deg, rgba(255, 68, 255, 0.15) 0%, rgba(200, 50, 200, 0.05) 100%);
            border-color: rgba(255, 68, 255, 0.5);
        }

        .health-panel .status-title { color: #ff44ff; }

        .health-stat {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px;
            background: rgba(255, 68, 255, 0.1);
            border-radius: 6px;
            margin-bottom: 8px;
        }

        .health-icon { font-size: 20px; }
        .health-value { font-size: 18px; font-weight: bold; color: #fff; }
        .health-label { font-size: 10px; color: #ff44ff; }

        .heart-animation {
            animation: heartbeat 1s infinite;
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        /* Music Panel */
        .music-panel {
            background: linear-gradient(135deg, rgba(136, 0, 255, 0.15) 0%, rgba(100, 0, 200, 0.05) 100%);
            border-color: rgba(136, 0, 255, 0.5);
        }

        .music-panel .status-title { color: #8800ff; }

        .now-playing {
            text-align: center;
            padding: 15px;
            background: rgba(136, 0, 255, 0.1);
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .song-title { font-size: 14px; font-weight: bold; color: #fff; margin-bottom: 5px; }
        .song-artist { font-size: 12px; color: #8800ff; }

        .music-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .music-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(136, 0, 255, 0.2);
            border: 1px solid #8800ff;
            color: #8800ff;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .music-btn:hover {
            background: #8800ff;
            color: #000;
        }

        .music-btn.play-btn {
            width: 50px;
            height: 50px;
            font-size: 20px;
        }

        .progress-bar {
            height: 4px;
            background: rgba(136, 0, 255, 0.3);
            border-radius: 2px;
            margin-top: 15px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #8800ff, #ff44ff);
            width: 35%;
            transition: width 0.3s;
        }

        /* Calendar Panel */
        .calendar-panel {
            background: linear-gradient(135deg, rgba(68, 255, 68, 0.15) 0%, rgba(50, 200, 50, 0.05) 100%);
            border-color: rgba(68, 255, 68, 0.5);
        }

        .calendar-panel .status-title { color: #44ff44; }

        .calendar-event {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: rgba(68, 255, 68, 0.1);
            border-radius: 6px;
            margin-bottom: 8px;
            border-left: 3px solid #44ff44;
        }

        .event-time { font-size: 11px; color: #44ff44; min-width: 50px; }
        .event-title { font-size: 12px; color: #fff; flex: 1; }

        /* Tasks Panel */
        .tasks-panel {
            background: linear-gradient(135deg, rgba(255, 255, 68, 0.15) 0%, rgba(200, 200, 50, 0.05) 100%);
            border-color: rgba(255, 255, 68, 0.5);
        }

        .tasks-panel .status-title { color: #ffff44; }

        .task-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            background: rgba(255, 255, 68, 0.1);
            border-radius: 6px;
            margin-bottom: 6px;
        }

        .task-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid #ffff44;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: transparent;
            transition: all 0.2s;
        }

        .task-checkbox.completed {
            background: #ffff44;
            color: #000;
        }

        .task-text { font-size: 12px; color: #fff; flex: 1; }
        .task-text.completed { text-decoration: line-through; opacity: 0.5; }

        .add-task-input {
            width: 100%;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 68, 0.3);
            border-radius: 6px;
            padding: 8px;
            color: #fff;
            font-size: 12px;
            margin-top: 10px;
        }

        /* Translation Panel */
        .translation-panel {
            background: linear-gradient(135deg, rgba(68, 255, 255, 0.15) 0%, rgba(50, 200, 200, 0.05) 100%);
            border-color: rgba(68, 255, 255, 0.5);
        }

        .translation-panel .status-title { color: #44ffff; }

        .translation-box {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(68, 255, 255, 0.3);
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 10px;
        }

        .translation-label { font-size: 10px; color: #44ffff; margin-bottom: 5px; }
        .translation-text { font-size: 14px; color: #fff; min-height: 40px; }

        .lang-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .lang-btn {
            flex: 1;
            padding: 8px;
            background: rgba(68, 255, 255, 0.1);
            border: 1px solid rgba(68, 255, 255, 0.3);
            border-radius: 6px;
            color: #44ffff;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .lang-btn.active, .lang-btn:hover {
            background: rgba(68, 255, 255, 0.3);
            border-color: #44ffff;
        }

        /* Gesture Panel */
        .gesture-panel {
            background: linear-gradient(135deg, rgba(255, 68, 68, 0.15) 0%, rgba(200, 50, 50, 0.05) 100%);
            border-color: rgba(255, 68, 68, 0.5);
        }

        .gesture-panel .status-title { color: #ff4444; }

        .gesture-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
        }

        .gesture-item {
            padding: 10px;
            background: rgba(255, 68, 68, 0.1);
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .gesture-item:hover {
            background: rgba(255, 68, 68, 0.3);
            transform: scale(1.05);
        }

        .gesture-icon { font-size: 24px; margin-bottom: 5px; }
        .gesture-name { font-size: 10px; color: #ff4444; }

        /* Camera Panel */
        .camera-panel {
            background: linear-gradient(135deg, rgba(100, 100, 100, 0.15) 0%, rgba(50, 50, 50, 0.05) 100%);
            border-color: rgba(150, 150, 150, 0.5);
        }

        .camera-panel .status-title { color: #aaaaaa; }

        .camera-view {
            width: 100%;
            height: 150px;
            background: linear-gradient(45deg, #111, #222);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            overflow: hidden;
            position: relative;
        }

        .camera-placeholder {
            color: #666;
            text-align: center;
        }

        .camera-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
        }

        .camera-btn {
            padding: 8px 16px;
            background: rgba(150, 150, 150, 0.2);
            border: 1px solid #666;
            border-radius: 6px;
            color: #aaa;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .camera-btn:hover {
            background: rgba(150, 150, 150, 0.4);
            color: #fff;
        }

        /* Settings Panel */
        .settings-panel {
            background: linear-gradient(135deg, rgba(100, 150, 255, 0.15) 0%, rgba(50, 100, 200, 0.05) 100%);
            border-color: rgba(100, 150, 255, 0.5);
        }

        .settings-panel .status-title { color: #6496ff; }

        .setting-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px;
            background: rgba(100, 150, 255, 0.1);
            border-radius: 6px;
            margin-bottom: 8px;
        }

        .setting-label { font-size: 12px; color: #fff; }

        .toggle-switch {
            width: 40px;
            height: 22px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 11px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s;
        }

        .toggle-switch.on { background: #00ff88; }

        .toggle-knob {
            width: 18px;
            height: 18px;
            background: #fff;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: all 0.3s;
        }

        .toggle-switch.on .toggle-knob { left: 20px; }

        .slider-setting {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .slider {
            flex: 1;
            height: 4px;
            background: rgba(100, 150, 255, 0.3);
            border-radius: 2px;
            position: relative;
        }

        .slider-fill {
            height: 100%;
            background: #6496ff;
            border-radius: 2px;
            width: 70%;
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .experience-selector {
                flex-wrap: wrap;
                max-width: 90%;
            }
        }
    </style>
</head>
<body>
    <div id="hud-container">
        <div class="connection-indicator" id="connectionStatus">üîó CONNECTING...</div>
        <div class="hud-grid"></div>

        <div class="main-grid">
            <!-- Status Panel -->
            <div class="hud-panel">
                <div class="status-title">üéØ AGENT STATUS</div>
                <div class="status-item">
                    <span>Agent:</span>
                    <span class="status-value" id="agentId">Loading...</span>
                </div>
                <div class="status-item">
                    <span>Mode:</span>
                    <span class="status-value" id="currentMode">STANDBY</span>
                </div>
                <div class="status-item">
                    <span>Location:</span>
                    <span class="status-value" id="location">Acquiring...</span>
                </div>
                <div class="status-item">
                    <span>Time:</span>
                    <span class="status-value" id="currentTime">--:--</span>
                </div>
                <div class="status-item">
                    <span>Battery:</span>
                    <span class="status-value" id="battery">---%</span>
                </div>
                <div class="status-item">
                    <span>Connection:</span>
                    <span class="status-value" id="connection">CONNECTING</span>
                </div>
            </div>

            <!-- Weather Panel -->
            <div class="hud-panel">
                <div class="status-title">üå§Ô∏è ENVIRONMENTAL DATA</div>
                <div class="status-item">
                    <span>Temperature:</span>
                    <span class="status-value" id="temperature">Loading...</span>
                </div>
                <div class="status-item">
                    <span>Condition:</span>
                    <span class="status-value" id="weatherCondition">--</span>
                </div>
                <div class="status-item">
                    <span>Humidity:</span>
                    <span class="status-value" id="humidity">--%</span>
                </div>
                <div class="status-item">
                    <span>Wind:</span>
                    <span class="status-value" id="windSpeed">-- km/h</span>
                </div>
            </div>

            <!-- Jarvis AI Assistant -->
            <div class="hud-panel jarvis-panel">
                <div class="status-title">ü§ñ JARVIS AI ASSISTANT</div>
                <button class="jarvis-voice-btn" id="jarvisVoice" onclick="xrealSystem.toggleJarvisVoice()">üé§</button>
                <input type="text" class="jarvis-input" id="jarvisInput" placeholder="Ask Jarvis anything..." onkeypress="if(event.key==='Enter') xrealSystem.askJarvis()">
                <div class="jarvis-response" id="jarvisResponse">
                    üëã ŸÖÿ±ÿ≠ÿ®ÿßŸã! ÿ£ŸÜÿß ÿ¨ÿßÿ±ŸÅŸäÿ≥ÿå ŸÖÿ≥ÿßÿπÿØŸÉ ÿßŸÑÿ∞ŸÉŸä. ŸÉŸäŸÅ ÿ£ŸÇÿØÿ± ÿ£ÿ≥ÿßÿπÿØŸÉ ÿßŸÑŸäŸàŸÖÿü
                </div>
            </div>

            <!-- Health Monitoring -->
            <div class="hud-panel health-panel">
                <div class="status-title">‚ù§Ô∏è HEALTH MONITORING</div>
                <div class="health-stat">
                    <span class="health-icon heart-animation">‚ù§Ô∏è</span>
                    <div>
                        <div class="health-value" id="heartRate">72</div>
                        <div class="health-label">BPM</div>
                    </div>
                </div>
                <div class="health-stat">
                    <span class="health-icon">üëü</span>
                    <div>
                        <div class="health-value" id="steps">8,247</div>
                        <div class="health-label">STEPS</div>
                    </div>
                </div>
                <div class="health-stat">
                    <span class="health-icon">üî•</span>
                    <div>
                        <div class="health-value" id="calories">420</div>
                        <div class="health-label">CALORIES</div>
                    </div>
                </div>
                <div class="health-stat">
                    <span class="health-icon">üò¥</span>
                    <div>
                        <div class="health-value" id="sleepHours">7.5</div>
                        <div class="health-label">HOURS SLEEP</div>
                    </div>
                </div>
            </div>

            <!-- Music Player -->
            <div class="hud-panel music-panel">
                <div class="status-title">üéµ MUSIC PLAYER</div>
                <div class="now-playing">
                    <div class="song-title" id="songTitle">Blinding Lights</div>
                    <div class="song-artist" id="songArtist">The Weeknd</div>
                </div>
                <div class="music-controls">
                    <button class="music-btn" onclick="xrealSystem.musicPrev()">‚èÆÔ∏è</button>
                    <button class="music-btn play-btn" id="playBtn" onclick="xrealSystem.musicToggle()">‚ñ∂Ô∏è</button>
                    <button class="music-btn" onclick="xrealSystem.musicNext()">‚è≠Ô∏è</button>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="musicProgress"></div>
                </div>
            </div>

            <!-- Calendar -->
            <div class="hud-panel calendar-panel">
                <div class="status-title">üìÖ TODAY'S SCHEDULE</div>
                <div id="calendarEvents">
                    <div class="calendar-event">
                        <span class="event-time">09:00</span>
                        <span class="event-title">Team Meeting</span>
                    </div>
                    <div class="calendar-event">
                        <span class="event-time">12:00</span>
                        <span class="event-title">Lunch Break</span>
                    </div>
                    <div class="calendar-event">
                        <span class="event-time">15:00</span>
                        <span class="event-title">Project Review</span>
                    </div>
                    <div class="calendar-event">
                        <span class="event-time">18:00</span>
                        <span class="event-title">Gym Session</span>
                    </div>
                </div>
            </div>

            <!-- Tasks/Reminders -->
            <div class="hud-panel tasks-panel">
                <div class="status-title">‚úÖ TASKS & REMINDERS</div>
                <div id="tasksList">
                    <div class="task-item">
                        <div class="task-checkbox" onclick="xrealSystem.toggleTask(this)">‚úì</div>
                        <span class="task-text">Reply to emails</span>
                    </div>
                    <div class="task-item">
                        <div class="task-checkbox" onclick="xrealSystem.toggleTask(this)">‚úì</div>
                        <span class="task-text">Buy groceries</span>
                    </div>
                    <div class="task-item">
                        <div class="task-checkbox completed" onclick="xrealSystem.toggleTask(this)">‚úì</div>
                        <span class="task-text completed">Morning workout</span>
                    </div>
                </div>
                <input type="text" class="add-task-input" id="newTaskInput" placeholder="+ Add new task..." onkeypress="if(event.key==='Enter') xrealSystem.addTask()">
            </div>

            <!-- Translation -->
            <div class="hud-panel translation-panel">
                <div class="status-title">üåê LIVE TRANSLATOR</div>
                <div class="lang-selector">
                    <button class="lang-btn active" onclick="xrealSystem.setSourceLang('en')">English</button>
                    <button class="lang-btn" onclick="xrealSystem.setSourceLang('ar')">ÿßŸÑÿπÿ±ÿ®Ÿäÿ©</button>
                    <button class="lang-btn" onclick="xrealSystem.setSourceLang('es')">Espa√±ol</button>
                </div>
                <div class="translation-box">
                    <div class="translation-label">INPUT</div>
                    <input type="text" class="jarvis-input" id="translateInput" placeholder="Type text to translate..." oninput="xrealSystem.translateText()">
                </div>
                <div class="translation-box">
                    <div class="translation-label">TRANSLATION</div>
                    <div class="translation-text" id="translatedText">ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ© ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß...</div>
                </div>
            </div>

            <!-- Gesture Controls -->
            <div class="hud-panel gesture-panel">
                <div class="status-title">üëã GESTURE CONTROLS</div>
                <div class="gesture-list">
                    <div class="gesture-item" onclick="xrealSystem.executeGesture('swipe_left')">
                        <div class="gesture-icon">üëà</div>
                        <div class="gesture-name">Swipe Left</div>
                    </div>
                    <div class="gesture-item" onclick="xrealSystem.executeGesture('swipe_right')">
                        <div class="gesture-icon">üëâ</div>
                        <div class="gesture-name">Swipe Right</div>
                    </div>
                    <div class="gesture-item" onclick="xrealSystem.executeGesture('pinch')">
                        <div class="gesture-icon">ü§è</div>
                        <div class="gesture-name">Pinch</div>
                    </div>
                    <div class="gesture-item" onclick="xrealSystem.executeGesture('fist')">
                        <div class="gesture-icon">‚úä</div>
                        <div class="gesture-name">Fist</div>
                    </div>
                    <div class="gesture-item" onclick="xrealSystem.executeGesture('point')">
                        <div class="gesture-icon">‚òùÔ∏è</div>
                        <div class="gesture-name">Point</div>
                    </div>
                    <div class="gesture-item" onclick="xrealSystem.executeGesture('wave')">
                        <div class="gesture-icon">üëã</div>
                        <div class="gesture-name">Wave</div>
                    </div>
                </div>
            </div>

            <!-- Rear Camera -->
            <div class="hud-panel camera-panel">
                <div class="status-title">üìπ REAR VIEW CAMERA</div>
                <div class="camera-view" id="rearCamera">
                    <div class="camera-placeholder">
                        <div style="font-size: 40px;">üì∑</div>
                        <div style="font-size: 12px;">Tap to activate camera</div>
                    </div>
                </div>
                <div class="camera-controls">
                    <button class="camera-btn" onclick="xrealSystem.toggleCamera()">üìπ Toggle</button>
                    <button class="camera-btn" onclick="xrealSystem.capturePhoto()">üì∏ Capture</button>
                    <button class="camera-btn" onclick="xrealSystem.switchCamera()">üîÑ Switch</button>
                </div>
            </div>

            <!-- Quick Settings -->
            <div class="hud-panel settings-panel">
                <div class="status-title">‚öôÔ∏è QUICK SETTINGS</div>
                <div class="setting-item">
                    <span class="setting-label">üîä Sound Alerts</span>
                    <div class="toggle-switch on" id="soundToggle" onclick="xrealSystem.toggleSetting('sound')">
                        <div class="toggle-knob"></div>
                    </div>
                </div>
                <div class="setting-item">
                    <span class="setting-label">üì≥ Vibration</span>
                    <div class="toggle-switch on" id="vibrationToggle" onclick="xrealSystem.toggleSetting('vibration')">
                        <div class="toggle-knob"></div>
                    </div>
                </div>
                <div class="setting-item">
                    <span class="setting-label">üåô Dark Mode</span>
                    <div class="toggle-switch on" id="darkToggle" onclick="xrealSystem.toggleSetting('dark')">
                        <div class="toggle-knob"></div>
                    </div>
                </div>
                <div class="setting-item">
                    <span class="setting-label">üîî Notifications</span>
                    <div class="toggle-switch on" id="notifToggle" onclick="xrealSystem.toggleSetting('notifications')">
                        <div class="toggle-knob"></div>
                    </div>
                </div>
                <div class="setting-item">
                    <span class="setting-label">üîÜ Brightness</span>
                    <div class="slider-setting">
                        <div class="slider">
                            <div class="slider-fill" id="brightnessSlider"></div>
                        </div>
                        <span style="color: #6496ff;">70%</span>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="hud-panel">
                <div class="status-title">‚ö° QUICK ACTIONS</div>
                <button class="action-btn" onclick="xrealSystem.executeAction('call')">üìû Secure Call</button>
                <button class="action-btn" onclick="xrealSystem.executeAction('message')">üí¨ Send Message</button>
                <button class="action-btn" onclick="xrealSystem.executeAction('navigate')">üó∫Ô∏è Navigate</button>
                <button class="action-btn" onclick="xrealSystem.shareLocation()">üìç Share Location</button>
                <button class="action-btn" onclick="xrealSystem.emergency()">üö® Emergency</button>
            </div>
        </div>

        <!-- Experience Mode Selector -->
        <div class="experience-selector">
            <button class="experience-btn active" data-mode="standby" onclick="xrealSystem.switchMode('standby')">üè† Standby</button>
            <button class="experience-btn" data-mode="driving" onclick="xrealSystem.switchMode('driving')">üöó Driving</button>
            <button class="experience-btn" data-mode="meeting" onclick="xrealSystem.switchMode('meeting')">üë• Meeting</button>
            <button class="experience-btn" data-mode="phone" onclick="xrealSystem.switchMode('phone')">üì± Apps</button>
            <button class="experience-btn" data-mode="fitness" onclick="xrealSystem.switchMode('fitness')">üí™ Fitness</button>
        </div>
    </div>

    <!-- Call Overlay -->
    <div id="callOverlay" class="call-overlay">
        <div class="call-info">
            <div id="callContact" class="call-contact">ÿßÿ™ÿµÿßŸÑ ÿ¨ÿßÿ±Ÿä...</div>
            <div id="callStatus" class="call-status">ÿ¨ÿßÿ±Ÿä ÿßŸÑÿßÿ™ÿµÿßŸÑ...</div>
            <div id="callDuration" class="call-duration">00:00</div>
        </div>
        <div class="audio-visualizer" id="audioVisualizer">
            <div class="audio-bar"></div>
            <div class="audio-bar"></div>
            <div class="audio-bar"></div>
            <div class="audio-bar"></div>
            <div class="audio-bar"></div>
        </div>
        <div class="call-controls">
            <button class="call-btn end" onclick="xrealSystem.endCall()">üìû</button>
        </div>
    </div>

    <script>
        class XRealIntegratedSystem {
            constructor() {
                this.currentMode = 'standby';
                this.socket = null;
                this.isConnected = false;
                this.userData = null;
                this.location = { lat: null, lon: null };
                this.sessionStartTime = new Date();
                this.authToken = null;
                this.isPlaying = false;
                this.currentSongIndex = 0;
                this.soundEnabled = true;
                this.jarvisListening = false;
                this.cameraActive = false;
                this.cameraStream = null;
                
                this.sourceLang = 'en';
                
                this.songs = [
                    { title: 'Blinding Lights', artist: 'The Weeknd' },
                    { title: 'Levitating', artist: 'Dua Lipa' },
                    { title: 'Save Your Tears', artist: 'The Weeknd' },
                    { title: 'Stay', artist: 'Kid Laroi & Justin Bieber' },
                    { title: 'Heat Waves', artist: 'Glass Animals' }
                ];
                
                this.jarvisResponses = {
                    'hello': 'ŸÖÿ±ÿ≠ÿ®ÿßŸã! ŸÉŸäŸÅ ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ÿßŸÑŸäŸàŸÖÿü',
                    'time': `ÿßŸÑŸàŸÇÿ™ ÿßŸÑÿ¢ŸÜ ${new Date().toLocaleTimeString('ar-EG')}`,
                    'weather': 'ÿßŸÑÿ∑ŸÇÿ≥ ÿßŸÑŸäŸàŸÖ ŸÖÿπÿ™ÿØŸÑÿå ÿØÿ±ÿ¨ÿ© ÿßŸÑÿ≠ÿ±ÿßÿ±ÿ© ÿ≠ŸàÿßŸÑŸä 25 ÿØÿ±ÿ¨ÿ©',
                    'call': 'ÿ¨ÿßÿ±Ÿä ÿ®ÿØÿ° ÿßŸÑŸÖŸÉÿßŸÑŸÖÿ© ÿßŸÑÿ¢ŸÖŸÜÿ©...',
                    'music': 'ÿ¨ÿßÿ±Ÿä ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑŸÖŸàÿ≥ŸäŸÇŸâ...',
                    'help': 'ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ŸÅŸä: ÿßŸÑŸÖŸÉÿßŸÑŸÖÿßÿ™ÿå ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑÿå ÿßŸÑŸÖŸÑÿßÿ≠ÿ©ÿå ÿßŸÑÿ∑ŸÇÿ≥ÿå ÿßŸÑŸÖŸàÿ≥ŸäŸÇŸâÿå ŸàÿßŸÑŸÖÿ≤ŸäÿØ!',
                    'default': 'ŸÅŸáŸÖÿ™ ÿ∑ŸÑÿ®ŸÉ. ŸáŸÑ ÿ™ÿ±ŸäÿØ ŸÖŸÜŸä ÿ™ŸÜŸÅŸäÿ∞ ÿ£Ÿä ÿ•ÿ¨ÿ±ÿßÿ° ŸÖÿ≠ÿØÿØÿü'
                };
                
                this.init();
            }

            async init() {
                this.showConnectionStatus('Initializing systems...');
                await this.connectToAPI();
                this.connectWebSocket();
                this.startTimeUpdates();
                this.startLocationTracking();
                this.startBatteryMonitoring();
                this.startHealthSimulation();
                this.playStartupSound();
            }

            async connectToAPI() {
                try {
                    const response = await fetch('/api/health');
                    const health = await response.json();
                    
                    if (health.status === 'ok') {
                        document.getElementById('agentId').textContent = 'AGENT-' + Math.floor(Math.random() * 999 + 1).toString().padStart(3, '0');
                        console.log('API connected successfully');
                    }
                    
                    await this.loadWeatherData();
                } catch (error) {
                    console.error('API connection failed:', error);
                    document.getElementById('agentId').textContent = 'AGENT-001';
                    await this.loadWeatherData();
                }
            }

            connectWebSocket() {
                const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
                const wsHost = window.location.hostname;
                const wsPort = 8080;
                const wsUrl = `${protocol}//${wsHost}:${wsPort}`;
                
                this.socket = new WebSocket(wsUrl);
                
                this.socket.onopen = () => {
                    this.isConnected = true;
                    this.showConnectionStatus('üü¢ LIVE CONNECTION', 'connected');
                    document.getElementById('connection').textContent = 'SECURE';
                    
                    if (this.authToken) {
                        this.socket.send(JSON.stringify({ type: 'auth', token: this.authToken }));
                    }
                };
                
                this.socket.onmessage = (event) => {
                    try {
                        const data = JSON.parse(event.data);
                        this.handleWebSocketMessage(data);
                    } catch (e) {
                        console.log('WS message:', event.data);
                    }
                };
                
                this.socket.onclose = () => {
                    this.isConnected = false;
                    this.showConnectionStatus('üî¥ RECONNECTING...', 'disconnected');
                    document.getElementById('connection').textContent = 'OFFLINE';
                    setTimeout(() => this.connectWebSocket(), 3000);
                };
            }

            handleWebSocketMessage(data) {
                switch(data.type) {
                    case 'call_status':
                    case 'call_timer':
                    case 'message_received':
                        this.handleLiveCommunication(data);
                        break;
                    case 'notification':
                        this.showNotification(data.title || 'Notification', data.message);
                        this.playNotificationSound();
                        break;
                }
            }

            handleLiveCommunication(data) {
                switch(data.type) {
                    case 'call_status':
                        this.updateCallStatus(data.data);
                        break;
                    case 'call_timer':
                        this.updateCallTimer(data.data.duration);
                        break;
                    case 'message_received':
                        this.showIncomingMessage(data.data);
                        break;
                }
            }

            async loadWeatherData() {
                try {
                    const response = await fetch('/api/weather');
                    const weather = await response.json();
                    
                    document.getElementById('temperature').textContent = weather.temperature + '¬∞C';
                    document.getElementById('weatherCondition').textContent = weather.condition || 'Clear';
                    document.getElementById('humidity').textContent = (weather.humidity || 50) + '%';
                    document.getElementById('windSpeed').textContent = (weather.windSpeed || 10) + ' km/h';
                } catch (error) {
                    document.getElementById('temperature').textContent = '25¬∞C';
                    document.getElementById('weatherCondition').textContent = 'Clear';
                }
            }

            startTimeUpdates() {
                const updateTime = () => {
                    const now = new Date();
                    document.getElementById('currentTime').textContent = now.toLocaleTimeString('en-US', { hour12: false });
                };
                updateTime();
                setInterval(updateTime, 1000);
            }

            startLocationTracking() {
                if (navigator.geolocation) {
                    navigator.geolocation.watchPosition(
                        async (position) => {
                            this.location.lat = position.coords.latitude;
                            this.location.lon = position.coords.longitude;
                            
                            try {
                                const response = await fetch(`/api/location/reverse?lat=${this.location.lat}&lon=${this.location.lon}`);
                                const data = await response.json();
                                document.getElementById('location').textContent = data.address || 'Located';
                            } catch (e) {
                                document.getElementById('location').textContent = `${this.location.lat.toFixed(2)}, ${this.location.lon.toFixed(2)}`;
                            }
                        },
                        () => {
                            document.getElementById('location').textContent = 'Location unavailable';
                        },
                        { enableHighAccuracy: true }
                    );
                }
            }

            startBatteryMonitoring() {
                if (navigator.getBattery) {
                    navigator.getBattery().then(battery => {
                        const updateBattery = () => {
                            document.getElementById('battery').textContent = Math.round(battery.level * 100) + '%';
                        };
                        updateBattery();
                        battery.addEventListener('levelchange', updateBattery);
                    });
                } else {
                    document.getElementById('battery').textContent = '100%';
                }
            }

            startHealthSimulation() {
                setInterval(() => {
                    const hr = 65 + Math.floor(Math.random() * 20);
                    document.getElementById('heartRate').textContent = hr;
                    
                    const currentSteps = parseInt(document.getElementById('steps').textContent.replace(',', '')) || 8000;
                    const newSteps = currentSteps + Math.floor(Math.random() * 10);
                    document.getElementById('steps').textContent = newSteps.toLocaleString();
                    
                    const calories = Math.floor(newSteps * 0.05);
                    document.getElementById('calories').textContent = calories;
                }, 5000);
            }

            switchMode(mode) {
                this.currentMode = mode;
                document.querySelectorAll('.experience-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
                document.getElementById('currentMode').textContent = mode.toUpperCase();
                this.showNotification('Mode Changed', `Switched to ${mode.toUpperCase()} mode`);
                this.playBeep(600, 0.2, 100);
            }

            async executeAction(action) {
                const button = event?.target;
                if (button) button.classList.add('processing');
                
                try {
                    const headers = { 'Content-Type': 'application/json' };
                    if (this.authToken) headers['Authorization'] = `Bearer ${this.authToken}`;
                    
                    const response = await fetch(`/api/actions/${action}`, {
                        method: 'POST',
                        headers,
                        body: JSON.stringify({ 
                            data: { 
                                timestamp: new Date().toISOString(),
                                mode: this.currentMode,
                                contact: action === 'call' ? 'ÿ£ÿ≠ŸÖÿØ ÿßŸÑÿπŸÑŸä' : 'ÿ≥ÿßÿ±ÿ© ŸÖÿ≠ŸÖÿØ',
                                message: 'ŸÖÿ±ÿ≠ÿ®ÿßŸã ŸÖŸÜ XReal AR! üì±'
                            } 
                        })
                    });
                    
                    const result = await response.json();
                    if (result.success) {
                        this.showNotification('Action Completed', result.message);
                        this.playNotificationSound();
                    }
                } catch (error) {
                    this.showNotification('Error', 'Action failed', 'error');
                } finally {
                    if (button) button.classList.remove('processing');
                }
            }

            // Jarvis AI Methods
            toggleJarvisVoice() {
                const btn = document.getElementById('jarvisVoice');
                this.jarvisListening = !this.jarvisListening;
                btn.classList.toggle('listening', this.jarvisListening);
                
                if (this.jarvisListening) {
                    this.showNotification('Jarvis', 'Listening... Speak now');
                    this.startSpeechRecognition();
                } else {
                    this.showNotification('Jarvis', 'Voice input disabled');
                }
            }

            startSpeechRecognition() {
                if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                    const recognition = new SpeechRecognition();
                    recognition.lang = 'ar-SA';
                    recognition.continuous = false;
                    
                    recognition.onresult = (event) => {
                        const text = event.results[0][0].transcript;
                        document.getElementById('jarvisInput').value = text;
                        this.askJarvis();
                    };
                    
                    recognition.onerror = () => {
                        document.getElementById('jarvisVoice').classList.remove('listening');
                        this.jarvisListening = false;
                    };
                    
                    recognition.onend = () => {
                        document.getElementById('jarvisVoice').classList.remove('listening');
                        this.jarvisListening = false;
                    };
                    
                    recognition.start();
                } else {
                    this.showNotification('Jarvis', 'Speech recognition not supported');
                }
            }

            askJarvis() {
                const input = document.getElementById('jarvisInput').value.toLowerCase();
                const response = document.getElementById('jarvisResponse');
                
                let answer = this.jarvisResponses.default;
                
                if (input.includes('hello') || input.includes('ŸÖÿ±ÿ≠ÿ®ÿß') || input.includes('hi')) {
                    answer = this.jarvisResponses.hello;
                } else if (input.includes('time') || input.includes('ŸàŸÇÿ™') || input.includes('ÿ≥ÿßÿπÿ©')) {
                    answer = `ÿßŸÑŸàŸÇÿ™ ÿßŸÑÿ¢ŸÜ ${new Date().toLocaleTimeString('ar-EG')}`;
                } else if (input.includes('weather') || input.includes('ÿ∑ŸÇÿ≥')) {
                    answer = this.jarvisResponses.weather;
                } else if (input.includes('call') || input.includes('ÿßÿ™ÿµŸÑ')) {
                    answer = this.jarvisResponses.call;
                    setTimeout(() => this.executeAction('call'), 1000);
                } else if (input.includes('music') || input.includes('ŸÖŸàÿ≥ŸäŸÇŸâ')) {
                    answer = this.jarvisResponses.music;
                    this.musicToggle();
                } else if (input.includes('help') || input.includes('ŸÖÿ≥ÿßÿπÿØÿ©')) {
                    answer = this.jarvisResponses.help;
                }
                
                response.textContent = answer;
                this.speakText(answer);
                document.getElementById('jarvisInput').value = '';
            }

            speakText(text) {
                if ('speechSynthesis' in window && this.soundEnabled) {
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'ar-SA';
                    utterance.rate = 0.9;
                    speechSynthesis.speak(utterance);
                }
            }

            // Music Player Methods
            musicToggle() {
                this.isPlaying = !this.isPlaying;
                document.getElementById('playBtn').textContent = this.isPlaying ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è';
                this.showNotification('Music', this.isPlaying ? 'Playing...' : 'Paused');
                if (this.isPlaying) this.playBeep(440, 0.1, 100);
            }

            musicNext() {
                this.currentSongIndex = (this.currentSongIndex + 1) % this.songs.length;
                this.updateSongDisplay();
            }

            musicPrev() {
                this.currentSongIndex = (this.currentSongIndex - 1 + this.songs.length) % this.songs.length;
                this.updateSongDisplay();
            }

            updateSongDisplay() {
                const song = this.songs[this.currentSongIndex];
                document.getElementById('songTitle').textContent = song.title;
                document.getElementById('songArtist').textContent = song.artist;
                this.showNotification('Now Playing', `${song.title} - ${song.artist}`);
            }

            // Task Methods
            toggleTask(checkbox) {
                checkbox.classList.toggle('completed');
                const taskText = checkbox.nextElementSibling;
                taskText.classList.toggle('completed');
                this.playBeep(checkbox.classList.contains('completed') ? 800 : 400, 0.1, 100);
            }

            addTask() {
                const input = document.getElementById('newTaskInput');
                const text = input.value.trim();
                if (!text) return;
                
                const taskList = document.getElementById('tasksList');
                const taskItem = document.createElement('div');
                taskItem.className = 'task-item';
                taskItem.innerHTML = `
                    <div class="task-checkbox" onclick="xrealSystem.toggleTask(this)">‚úì</div>
                    <span class="task-text">${text}</span>
                `;
                taskList.appendChild(taskItem);
                input.value = '';
                this.showNotification('Task Added', text);
                this.playNotificationSound();
            }

            // Translation Methods
            setSourceLang(lang) {
                this.sourceLang = lang;
                document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
                event.target.classList.add('active');
                this.translateText();
            }

            async translateText() {
                const input = document.getElementById('translateInput').value;
                const output = document.getElementById('translatedText');
                
                if (!input) {
                    output.textContent = 'ÿßŸÑÿ™ÿ±ÿ¨ŸÖÿ© ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß...';
                    return;
                }
                
                const enToAr = {
                    'hello': 'ŸÖÿ±ÿ≠ÿ®ÿßŸã', 'hi': 'ÿ£ŸáŸÑÿßŸã', 'hey': 'ŸáÿßŸä',
                    'how are you': 'ŸÉŸäŸÅ ÿ≠ÿßŸÑŸÉÿü', 'how are you?': 'ŸÉŸäŸÅ ÿ≠ÿßŸÑŸÉÿü',
                    'thank you': 'ÿ¥ŸÉÿ±ÿßŸã ŸÑŸÉ', 'thanks': 'ÿ¥ŸÉÿ±ÿßŸã',
                    'good morning': 'ÿµÿ®ÿßÿ≠ ÿßŸÑÿÆŸäÿ±', 'good evening': 'ŸÖÿ≥ÿßÿ° ÿßŸÑÿÆŸäÿ±',
                    'good night': 'ÿ™ÿµÿ®ÿ≠ ÿπŸÑŸâ ÿÆŸäÿ±', 'goodnight': 'ÿ™ÿµÿ®ÿ≠ ÿπŸÑŸâ ÿÆŸäÿ±',
                    'yes': 'ŸÜÿπŸÖ', 'no': 'ŸÑÿß', 'maybe': 'ÿ±ÿ®ŸÖÿß',
                    'please': 'ŸÖŸÜ ŸÅÿ∂ŸÑŸÉ', 'sorry': 'ÿ¢ÿ≥ŸÅ', 'excuse me': 'ÿπÿ∞ÿ±ÿßŸã',
                    'welcome': 'ÿ£ŸáŸÑÿßŸã Ÿàÿ≥ŸáŸÑÿßŸã', 'goodbye': 'ŸÖÿπ ÿßŸÑÿ≥ŸÑÿßŸÖÿ©', 'bye': 'ÿ®ÿßŸä',
                    'what': 'ŸÖÿßÿ∞ÿß', 'where': 'ÿ£ŸäŸÜ', 'when': 'ŸÖÿ™Ÿâ', 'why': 'ŸÑŸÖÿßÿ∞ÿß', 'who': 'ŸÖŸÜ', 'how': 'ŸÉŸäŸÅ',
                    'i love you': 'ÿ£ÿ≠ÿ®ŸÉ', 'i miss you': 'ÿßÿ¥ÿ™ŸÇÿ™ ŸÑŸÉ',
                    'my name is': 'ÿßÿ≥ŸÖŸä', 'what is your name': 'ŸÖÿß ÿßÿ≥ŸÖŸÉÿü',
                    'help': 'ŸÖÿ≥ÿßÿπÿØÿ©', 'help me': 'ÿ≥ÿßÿπÿØŸÜŸä',
                    'water': 'ŸÖÿßÿ°', 'food': 'ÿ∑ÿπÿßŸÖ', 'coffee': 'ŸÇŸáŸàÿ©', 'tea': 'ÿ¥ÿßŸä',
                    'today': 'ÿßŸÑŸäŸàŸÖ', 'tomorrow': 'ÿ∫ÿØÿßŸã', 'yesterday': 'ÿ£ŸÖÿ≥',
                    'morning': 'ÿµÿ®ÿßÿ≠', 'evening': 'ŸÖÿ≥ÿßÿ°', 'night': 'ŸÑŸäŸÑ',
                    'friend': 'ÿµÿØŸäŸÇ', 'family': 'ÿπÿßÿ¶ŸÑÿ©', 'love': 'ÿ≠ÿ®',
                    'happy': 'ÿ≥ÿπŸäÿØ', 'sad': 'ÿ≠ÿ≤ŸäŸÜ', 'angry': 'ÿ∫ÿßÿ∂ÿ®',
                    'beautiful': 'ÿ¨ŸÖŸäŸÑ', 'good': 'ÿ¨ŸäÿØ', 'bad': 'ÿ≥Ÿäÿ°',
                    'big': 'ŸÉÿ®Ÿäÿ±', 'small': 'ÿµÿ∫Ÿäÿ±', 'hot': 'ÿ≠ÿßÿ±', 'cold': 'ÿ®ÿßÿ±ÿØ',
                    'work': 'ÿπŸÖŸÑ', 'home': 'ÿ®Ÿäÿ™', 'car': 'ÿ≥Ÿäÿßÿ±ÿ©', 'phone': 'Ÿáÿßÿ™ŸÅ',
                    'money': 'ŸÖÿßŸÑ', 'time': 'ŸàŸÇÿ™', 'day': 'ŸäŸàŸÖ', 'year': 'ÿ≥ŸÜÿ©',
                    'one': 'Ÿàÿßÿ≠ÿØ', 'two': 'ÿßÿ´ŸÜÿßŸÜ', 'three': 'ÿ´ŸÑÿßÿ´ÿ©', 'four': 'ÿ£ÿ±ÿ®ÿπÿ©', 'five': 'ÿÆŸÖÿ≥ÿ©',
                    'call': 'ÿßÿ™ÿµÿßŸÑ', 'message': 'ÿ±ÿ≥ÿßŸÑÿ©', 'email': 'ÿ®ÿ±ŸäÿØ ÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä',
                    'meeting': 'ÿßÿ¨ÿ™ŸÖÿßÿπ', 'appointment': 'ŸÖŸàÿπÿØ',
                    'i am fine': 'ÿ£ŸÜÿß ÿ®ÿÆŸäÿ±', 'i am good': 'ÿ£ŸÜÿß ÿ®ÿÆŸäÿ±',
                    'see you later': 'ÿ£ÿ±ÿßŸÉ ŸÑÿßÿ≠ŸÇÿßŸã', 'take care': 'ÿßÿπÿ™ŸÜŸä ÿ®ŸÜŸÅÿ≥ŸÉ',
                    'good luck': 'ÿ≠ÿ∏ÿßŸã ÿ≥ÿπŸäÿØÿßŸã', 'congratulations': 'ŸÖÿ®ÿ±ŸàŸÉ'
                };
                
                const arToEn = {};
                Object.keys(enToAr).forEach(k => arToEn[enToAr[k]] = k);
                
                const enToEs = {
                    'hello': 'hola', 'hi': 'hola', 'hey': 'oye',
                    'how are you': '¬øc√≥mo est√°s?', 'how are you?': '¬øc√≥mo est√°s?',
                    'thank you': 'gracias', 'thanks': 'gracias',
                    'good morning': 'buenos d√≠as', 'good evening': 'buenas tardes',
                    'good night': 'buenas noches', 'yes': 's√≠', 'no': 'no',
                    'please': 'por favor', 'sorry': 'lo siento', 'excuse me': 'disculpe',
                    'welcome': 'bienvenido', 'goodbye': 'adi√≥s', 'bye': 'adi√≥s',
                    'i love you': 'te amo', 'help': 'ayuda', 'friend': 'amigo',
                    'water': 'agua', 'food': 'comida', 'coffee': 'caf√©',
                    'today': 'hoy', 'tomorrow': 'ma√±ana', 'yesterday': 'ayer'
                };
                
                const lowerInput = input.toLowerCase().trim();
                let result = null;
                
                if (this.sourceLang === 'ar' || /[\u0600-\u06FF]/.test(input)) {
                    result = arToEn[input] || arToEn[lowerInput];
                    if (result) result = result.charAt(0).toUpperCase() + result.slice(1);
                } else if (this.sourceLang === 'es') {
                    const esToEn = {};
                    Object.keys(enToEs).forEach(k => esToEn[enToEs[k]] = k);
                    result = esToEn[lowerInput];
                    if (result) result = result.charAt(0).toUpperCase() + result.slice(1);
                } else {
                    result = enToAr[lowerInput];
                }
                
                if (result) {
                    output.textContent = result;
                    this.playBeep(600, 0.1, 50);
                } else {
                    try {
                        const response = await fetch(`/api/actions/translate`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ data: { text: input, from: this.sourceLang || 'en', to: 'ar' } })
                        });
                        const data = await response.json();
                        output.textContent = data.translation || `"${input}" - ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ™ÿ±ÿ¨ŸÖÿ©`;
                    } catch (e) {
                        output.textContent = `"${input}" - ÿßŸÉÿ™ÿ® ŸÉŸÑŸÖÿ© ŸÖÿπÿ±ŸàŸÅÿ© ŸÑŸÑÿ™ÿ±ÿ¨ŸÖÿ©`;
                    }
                }
            }

            // Gesture Methods
            executeGesture(gesture) {
                const actions = {
                    'swipe_left': 'Previous screen',
                    'swipe_right': 'Next screen',
                    'pinch': 'Zoom out',
                    'fist': 'Select/Confirm',
                    'point': 'Navigate',
                    'wave': 'Dismiss/Back'
                };
                this.showNotification('Gesture', actions[gesture] || 'Gesture detected');
                this.playBeep(500, 0.15, 80);
            }

            // Camera Methods
            async toggleCamera() {
                const cameraView = document.getElementById('rearCamera');
                
                if (this.cameraActive && this.cameraStream) {
                    this.cameraStream.getTracks().forEach(track => track.stop());
                    this.cameraStream = null;
                    this.cameraActive = false;
                    cameraView.innerHTML = `
                        <div class="camera-placeholder">
                            <div style="font-size: 40px;">üì∑</div>
                            <div style="font-size: 12px;">Tap to activate camera</div>
                        </div>
                    `;
                    return;
                }
                
                try {
                    this.cameraStream = await navigator.mediaDevices.getUserMedia({ 
                        video: { facingMode: 'environment' } 
                    });
                    
                    const video = document.createElement('video');
                    video.srcObject = this.cameraStream;
                    video.autoplay = true;
                    video.style.width = '100%';
                    video.style.height = '100%';
                    video.style.objectFit = 'cover';
                    video.style.borderRadius = '8px';
                    
                    cameraView.innerHTML = '';
                    cameraView.appendChild(video);
                    this.cameraActive = true;
                    this.showNotification('Camera', 'Rear camera activated');
                } catch (error) {
                    this.showNotification('Camera', 'Camera access denied', 'error');
                }
            }

            capturePhoto() {
                if (!this.cameraActive) {
                    this.showNotification('Camera', 'Activate camera first');
                    return;
                }
                this.playBeep(1000, 0.3, 150);
                this.showNotification('Camera', 'Photo captured! üì∏');
            }

            switchCamera() {
                this.showNotification('Camera', 'Switching camera...');
            }

            // Settings Methods
            toggleSetting(setting) {
                const toggles = {
                    'sound': 'soundToggle',
                    'vibration': 'vibrationToggle',
                    'dark': 'darkToggle',
                    'notifications': 'notifToggle'
                };
                
                const toggle = document.getElementById(toggles[setting]);
                toggle.classList.toggle('on');
                
                if (setting === 'sound') {
                    this.soundEnabled = toggle.classList.contains('on');
                }
                
                this.showNotification('Settings', `${setting} ${toggle.classList.contains('on') ? 'enabled' : 'disabled'}`);
            }

            // Call Methods
            updateCallStatus(callData) {
                const overlay = document.getElementById('callOverlay');
                const contact = document.getElementById('callContact');
                const status = document.getElementById('callStatus');
                
                contact.textContent = callData.contact;
                
                switch(callData.status) {
                    case 'connecting':
                        status.textContent = 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿßÿ™ÿµÿßŸÑ...';
                        overlay.classList.add('active');
                        break;
                    case 'ringing':
                        status.textContent = 'Ÿäÿ±ŸÜ...';
                        this.playRingtone();
                        break;
                    case 'connected':
                        status.textContent = 'ŸÖÿ™ÿµŸÑ';
                        this.stopRingtone();
                        document.getElementById('audioVisualizer').style.display = 'flex';
                        break;
                    case 'ended':
                        overlay.classList.remove('active');
                        document.getElementById('audioVisualizer').style.display = 'none';
                        break;
                }
            }

            updateCallTimer(duration) {
                const timer = document.getElementById('callDuration');
                const minutes = Math.floor(duration / 60);
                const seconds = duration % 60;
                timer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }

            async endCall() {
                try {
                    await fetch('/api/actions/end_call', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ data: {} })
                    });
                    this.showNotification('Call', 'Call ended');
                } catch (error) {
                    console.error('Failed to end call:', error);
                }
            }

            showIncomingMessage(messageData) {
                const popup = document.createElement('div');
                popup.className = 'notification-popup';
                popup.innerHTML = `<strong>ÿ±ÿ≥ÿßŸÑÿ© ŸÖŸÜ ${messageData.from}</strong><br>${messageData.message}`;
                document.body.appendChild(popup);
                
                setTimeout(() => {
                    popup.style.opacity = '0';
                    setTimeout(() => popup.remove(), 500);
                }, 5000);
                
                this.playNotificationSound();
            }

            shareLocation() {
                if (this.location.lat && this.location.lon) {
                    this.showNotification('Location', 'Location shared securely');
                    this.playNotificationSound();
                } else {
                    this.showNotification('Location', 'Location not available', 'error');
                }
            }

            emergency() {
                this.showNotification('üö® EMERGENCY', 'Emergency protocols activated!', 'emergency');
                this.playBeep(1000, 0.5, 500);
            }

            showNotification(title, message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = 'notification-popup';
                notification.innerHTML = `<strong>${title}</strong><br>${message}`;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.opacity = '0';
                    setTimeout(() => notification.remove(), 500);
                }, 3000);
            }

            showConnectionStatus(message, status = 'connecting') {
                const indicator = document.getElementById('connectionStatus');
                indicator.textContent = message;
                indicator.className = `connection-indicator ${status}`;
            }

            // Audio Methods
            playStartupSound() {
                if (!this.soundEnabled) return;
                this.playBeep(400, 0.2, 100);
                setTimeout(() => this.playBeep(600, 0.2, 100), 150);
                setTimeout(() => this.playBeep(800, 0.3, 200), 300);
            }

            playNotificationSound() {
                if (!this.soundEnabled) return;
                this.playBeep(800, 0.2, 100);
                setTimeout(() => this.playBeep(1000, 0.2, 100), 100);
            }

            playRingtone() {
                this.ringtoneInterval = setInterval(() => {
                    this.playBeep(800, 0.3, 200);
                    setTimeout(() => this.playBeep(600, 0.3, 200), 300);
                }, 2000);
            }

            stopRingtone() {
                if (this.ringtoneInterval) {
                    clearInterval(this.ringtoneInterval);
                    this.ringtoneInterval = null;
                }
            }

            playBeep(frequency, volume, duration) {
                if (!this.soundEnabled) return;
                try {
                    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    oscillator.frequency.value = frequency;
                    gainNode.gain.value = volume;
                    
                    oscillator.start();
                    setTimeout(() => oscillator.stop(), duration);
                } catch (error) {
                    console.log('Audio not supported');
                }
            }
        }

        const xrealSystem = new XRealIntegratedSystem();

        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case '1': xrealSystem.switchMode('standby'); break;
                case '2': xrealSystem.switchMode('driving'); break;
                case '3': xrealSystem.switchMode('meeting'); break;
                case '4': xrealSystem.switchMode('phone'); break;
                case '5': xrealSystem.switchMode('fitness'); break;
                case 'j': case 'J': document.getElementById('jarvisInput').focus(); break;
            }
        });
    </script>
</body>
</html>
